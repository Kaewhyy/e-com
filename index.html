<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ShopEase - Modern E-Commerce</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Top Banner -->
    <div class="top-banner">
        <p>Free shipping on orders over $50 | <span id="current-date"></span></p>
    </div>

    <!-- Main Header -->
    <header class="main-header">
        <div class="container header-container">
            <div class="logo">
                <i class="fas fa-shopping-bag"></i>
                <h1>Tats&Merch</h1>
            </div>
            
            <div class="search-bar">
                <input type="text" placeholder="Search products...">
                <button><i class="fas fa-search"></i></button>
            </div>
            
            <nav class="main-nav">
                <ul>
                    <li><a href="#" data-view="products-view" class="nav-link active"><i class="fas fa-home"></i> Home</a></li>
                    <li><a href="#" data-view="products-view" class="nav-link"><i class="fas fa-store"></i> Shop</a></li>
                    <li><a href="#" data-view="about-view" class="nav-link"><i class="fas fa-info-circle"></i> About</a></li>
                    <li class="cart-icon">
                        <a href="#">
                            <i class="fas fa-shopping-cart"></i>
                            <span id="cart-count">0</span>
                        </a>
                    </li>
                </ul>
            </nav>
            
            <button class="mobile-menu-btn"><i class="fas fa-bars"></i></button>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="hero">
        <div class="hero-content">
            <h2>Summer Collection 2023</h2>
            <p>Discover our new arrivals with up to 30% off</p>
            <button class="btn-primary">Explore</button>
        </div>
    </section>

    <!-- Main Content -->
    <main class="container">
        <!-- Products View -->
<div id="products-view" class="page-view">
    <div class="section-header">
        <h2>Featured Products</h2>
        <div class="category-filter">
            <button class="category-btn active" data-category="all">All</button>
            <button class="category-btn" data-category="Electronics">Electronics</button>
            <button class="category-btn" data-category="Clothing">Clothing</button>
            <button class="category-btn" data-category="Home">Home & Kitchen</button>
        </div>
    </div>

    <div class="product-grid" id="product-list">
        <!-- Loading skeleton (simplified) -->
        <div class="product-card skeleton">
            <div class="product-image"></div>
            <div class="product-info">
                <h3></h3>
                <div class="price"></div>
                <div class="product-actions">
                    <button class="view-details-btn"><i class="fas fa-eye"></i> Details</button>
                    <button class="add-to-cart-btn"><i class="fas fa-cart-plus"></i> Add to Cart</button>
                </div>
            </div>
        </div>
        <!-- JavaScript will populate actual products here -->
    </div>
</div>

<!-- Product Detail View -->
<div id="product-detail-view" style="display: none;">
    <button class="back-button" onclick="showListView()">&laquo; Back to Products</button>
    <div id="product-detail-content"></div>
</div>

<!-- Shopping Cart Sidebar -->
<aside id="cart-sidebar">
    <div class="cart-header">
        <h3>Your Cart</h3>
        <button class="close-cart">&times;</button>
    </div>
    <div class="cart-items" id="cart-items">
        <p>Your cart is empty</p>
    </div>
    <div class="cart-footer">
        <div class="cart-total">
            <span>Total:</span>
            <span id="cart-total">₹0.00</span> <!-- Changed to ₹ for rupees -->
        </div>
        <button class="btn-checkout" id="checkout-button" onclick="checkout()">Proceed to Checkout</button>
    </div>
    <section class="checkout-form" id="checkout-section" style="display: none;">
        <h2>Checkout</h2>
        <form id="checkout-form">
            <div>
                <label for="name">Name:</label>
                <input type="text" id="name" required>
            </div>
            <div>
                <label for="email">Email:</label>
                <input type="email" id="email" required>
            </div>
            <button type="submit">Complete Purchase</button>
        </form>
    </section>
</aside>

<!-- Global Message Area -->
<div id="global-error" class="message-area"></div>
            <!-- Product Detail View (hidden by default) -->
            <div id="product-detail-view" style="display: none;">
                <button class="back-button" onclick="showListView()">&laquo; Back to Products</button>
                <div id="product-detail-content"></div>
            </div>
        </div>

        <!-- About View -->
        <div id="about-view" class="page-view" style="display: none;">
            <div class="about-section">
                <div class="about-content">
                    <h2>Our Story</h2>
                    <p>ShopEase was founded in 2023 with a simple mission: to provide high-quality products with exceptional customer service. We believe in making online shopping easy, enjoyable, and accessible to everyone.</p>
                    <div class="stats">
                        <div class="stat-item">
                            <h3>10,000+</h3>
                            <p>Happy Customers</p>
                        </div>
                        <div class="stat-item">
                            <h3>500+</h3>
                            <p>Quality Products</p>
                        </div>
                        <div class="stat-item">
                            <h3>24/7</h3>
                            <p>Customer Support</p>
                        </div>
                    </div>
                </div>
                <div class="about-image">
                    <img src="https://images.unsplash.com/photo-1556740738-b6a63e27c4df" alt="Our Team">
                </div>
            </div>
        </div>

        <nav>
            <a href="/inventory" class="inventory-link">Inventory Management</a>
        </nav>

        <!-- Shopping Cart Sidebar -->
        <aside id="cart-sidebar">
            <div class="cart-header">
                <h3>Your Cart</h3>
                <button class="close-cart">&times;</button>
            </div>
            <div class="cart-items" id="cart-items">
                <p>Your cart is empty</p>
            </div>
            <div class="cart-footer">
                <div class="cart-total">
                    <span>Total:</span>
                    <span id="cart-total">$0.00</span>
                </div>
                <button class="btn-checkout" id="checkout-button">Proceed to Checkout</button>
            </div>
        </aside>
    </main>

    <!-- Features Section -->
    <section class="features">
        <div class="container">
            <div class="feature">
                <i class="fas fa-truck"></i>
                <h3>Free Shipping</h3>
                <p>On orders over $50</p>
            </div>
            <div class="feature">
                <i class="fas fa-undo"></i>
                <h3>Easy Returns</h3>
                <p>30-day return policy</p>
            </div>
            <div class="feature">
                <i class="fas fa-lock"></i>
                <h3>Secure Payment</h3>
                <p>100% secure checkout</p>
            </div>
            <div class="feature">
                <i class="fas fa-headset"></i>
                <h3>24/7 Support</h3>
                <p>Dedicated support</p>
            </div>
        </div>
    </section>

    <!-- Newsletter -->
    <section class="newsletter">
        <div class="container">
            <h2>Subscribe to Our Newsletter</h2>
            <p>Get the latest updates on new products and upcoming sales</p>
            <form>
                <input type="email" placeholder="Your email address">
                <button type="submit" class="btn-primary">Subscribe</button>
            </form>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <div class="container footer-container">
            <div class="footer-col">
                <h3>ShopEase</h3>
                <p>Making online shopping easy and enjoyable since 2023.</p>
                <div class="social-icons">
                    <a href="#"><i class="fab fa-facebook-f"></i></a>
                    <a href="#"><i class="fab fa-twitter"></i></a>
                    <a href="#"><i class="fab fa-instagram"></i></a>
                    <a href="#"><i class="fab fa-pinterest"></i></a>
                </div>
            </div>
            <div class="footer-col">
                <h3>Quick Links</h3>
                <ul>
                    <li><a href="index.html">Home</a></li>
                    <li><a href="#">Shop</a></li>
                    <li><a href="about.html">About Us</a></li>
                    <li><a href="#">Contact</a></li>
                </ul>
            </div>
            <div class="footer-col">
                <h3>Customer Service</h3>
                <ul>
                    <li><a href="#">FAQ</a></li>
                    <li><a href="#">Shipping Policy</a></li>
                    <li><a href="#">Return Policy</a></li>
                    <li><a href="#">Privacy Policy</a></li>
                </ul>
            </div>
            <div class="footer-col">
                <h3>Contact Us</h3>
                <ul>
                    <li><i class="fas fa-map-marker-alt"></i> Salbari, Siliguri, West Bengal</li>
                    <li><i class="fas fa-phone"></i> 7602409259</li>
                    <li><i class="fas fa-envelope"></i> info@merch&tats.com</li>
                </ul>
            </div>
        </div>
        <div class="copyright">
            <p>&copy; 2023 Merch&Tats. All rights reserved.</p>
        </div>
    </footer>

    <!-- Back to Top Button -->
    <button id="back-to-top"><i class="fas fa-arrow-up"></i></button>

    <script src="script.js"></script>
    <script>
        let cart = [];
        
        // Load products on page load
        document.addEventListener('DOMContentLoaded', async () => {
            try {
                const response = await fetch('/api/products');
                const products = await response.json();
                renderProducts(products);
            } catch (error) {
                console.error('Error loading products:', error);
            }
        });

        function renderProducts(products) {
            const container = document.getElementById('product-list');
            container.innerHTML = products.map(product => `
                <div class="product-card">
                    <img src="${product.image_url}" alt="${product.name}">
                    <h3>${product.name}</h3>
                    <p>$${product.price.toFixed(2)}</p>
                    <p>${product.stock} in stock</p>
                    <button onclick="addToCart(${product.id})">Add to Cart</button>
                </div>
            `).join('');
        }

        function addToCart(productId) {
            const existingItem = cart.find(item => item.id === productId);
            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                cart.push({ id: productId, quantity: 1 });
            }
            updateCartUI();
        }

        function updateCartUI() {
            document.getElementById('cart-count').textContent = cart.length;
            if (cart.length > 0) {
                document.getElementById('checkout-section').style.display = 'block';
            }
        }

        // Handle checkout form submission
        document.getElementById('checkout-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const checkoutData = {
                items: cart,
                customer_name: document.getElementById('name').value,
                customer_email: document.getElementById('email').value
            };

            try {
                const response = await fetch('/api/checkout', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(checkoutData)
                });
                
                const result = await response.json();
                if (result.success) {
                    alert(`Order #${result.order_id} placed successfully! Total: $${result.total.toFixed(2)}`);
                    cart = [];
                    updateCartUI();
                    document.getElementById('checkout-section').style.display = 'none';
                    document.getElementById('checkout-form').reset();
                }
            } catch (error) {
                console.error('Checkout error:', error);
                alert('Checkout failed. Please try again.');
            }
        });
    </script>
</body>
</html>